#!/usr/bin/env bash
#    _   ___ ___
#   /_\ / __| _ \   Abhay Shanker Pathak
#  / _ \__ \  _/    abhaysp9955@gmail.com
# /_/ \_\___/_|     https://github.com/coolabhays
#
# Open man page in vim
# requires fzf and fd(for faster result)
# set env variable EDITOR to your preferred editor choice
# in my case it's nvim

getmanname() {
    man -k . | \
	fzf | \
	awk '{print $1}'
}

getshufman() {
	getname=$(fd . --type f /usr/share/man/man1 \
		| shuf \
		| head -n 1)
	propername=$(basename "${getname}" \
		| sed 's/.1.gz//g')
	echo "${propername}"
}

viman() {
    text=$(man "$@") && \
	echo "$text" | \
	"$EDITOR" -R +":set ft=man" - ;
}

case "$1" in
	-h) printf "%s\n%s\n%s\n%s\n" "There are three queries to pass:" \
		"-s for search" "-r for random(currently executable or shell commands only)" \
		"keyword";;
	-s) viman "$(getmanname)";;
	-r) viman "$(getshufman)";;
	*) viman "$1"
esac

# arrays are not part of posix so changed shebang to bash
